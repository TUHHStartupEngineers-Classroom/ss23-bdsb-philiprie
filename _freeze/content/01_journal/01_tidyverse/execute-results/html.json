{
  "hash": "b411ce3e9c8bc89c66a3b2404a2aa1bf",
  "result": {
    "markdown": "---\ntitle: \"Tidyverse\"\nauthor: \"Philip C. Riege\"\n---\n\n# Challenge 1 \nThe challenge was very similar to what was done in the introduction to the tidyverse beforehand and hence many parts of the code resemble the code that was shown in the chapter. \n\n\n\n\n::: {.cell hash='01_tidyverse_cache/html/unnamed-chunk-2_7d290a48e9e78de5cd63d69313fd6772'}\n\n```{.r .cell-code}\n# Sales by Location ----\n\n# Step 1 - Manipulate\nsales_by_loc_tbl <- bike_orderlines_wrangled_tbl %>%\n  select(state, total.price) %>%\n  group_by(state) %>%\n  summarize(sales = sum(total.price)) %>%\n  mutate(sales_text = scales::dollar(sales, big.mark = \".\",\n                                     decimal.mark = \",\",\n                                     prefix = \"\",\n                                     suffix = \" € \"))\n\n# Step 2 - Visualize\nsales_by_loc_tbl %>%\n  \n  # Setup canvas with the columns year (x-axis) and sales (y-axis)\n  ggplot(aes(x = state, y = sales)) +\n  theme(axis.text.x = element_text(angle = 45, hjust = 1)) +\n  \n  # Geometries\n  geom_col(fill = \"#2DC6D6\") + # Use geom_col for a bar plot\n  #geom_label(aes(label = sales_text)) + # Adding labels to the bars\n  \n  # Formatting\n  # scale_y_continuous(labels = scales::dollar) + # Change the y-axis. \n  # Again, we have to adjust it for euro values\n  scale_y_continuous(labels = scales::dollar_format(big.mark = \".\", \n                                                    decimal.mark = \",\", \n                                                    prefix = \"\", \n                                                    suffix = \" €\")) +\n  labs(\n    title    = \"Revenue by state \",\n    subtitle = \"Total revenue of the years 2015 to 2019\",\n    x = \"\", # Override defaults for x and y\n    y = \"Revenue\"\n  )\n```\n\n::: {.cell-output-display}\n![](01_tidyverse_files/figure-html/unnamed-chunk-2-1.png){width=672}\n:::\n\n```{.r .cell-code}\n# Sales by Year and Location ----\n\n# Step 1 - Manipulate\nsales_by_year_loc_tbl <- bike_orderlines_wrangled_tbl %>%\n  select(order.date, total.price, state) %>%\n  mutate(year = year(order.date)) %>%\n  group_by(year, state) %>%\n  summarize(sales = sum(total.price)) %>%\n  ungroup() %>%\n  mutate(sales_text = scales::dollar(sales, big.mark = \".\",\n                                     decimal.mark = \",\",\n                                     prefix = \"\",\n                                     suffix = \" € \"))\n# Step 2 - Visualize\nsales_by_year_loc_tbl %>%\n  \n  # Set up x, y, fill\n  ggplot(aes(x = year, y = sales, fill = state)) +\n  theme(axis.text.x = element_text(angle = 90, hjust = 1)) +\n  # Geometries\n  geom_col() + # Run up to here to get a stacked bar plot\n  geom_smooth(method = \"lm\", se = FALSE) + # Adding a trendline\n  \n  # Facet\n  facet_wrap(~ state) +\n  \n  # Formatting\n  scale_y_continuous(labels = scales::dollar_format(big.mark = \".\", \n                                                    decimal.mark = \",\", \n                                                    prefix = \"\", \n                                                    suffix = \" €\")) +\n  labs(\n    title = \"Revenue by year and location\",\n    subtitle = \"\",\n    fill = \"State\" # Changes the legend name\n  )\n```\n\n::: {.cell-output-display}\n![](01_tidyverse_files/figure-html/unnamed-chunk-2-2.png){width=672}\n:::\n\n```{.r .cell-code}\n#  Writing Files ----\n\nbike_orderlines_wrangled_tbl %>%\n  write_xlsx(\"01_tidyverse_files/01_bike_sales/02_wrangled_data/bike_orderlines.xlsx\")\n\n# CSV ----\nbike_orderlines_wrangled_tbl %>% \n  write_csv(\"01_tidyverse_files/01_bike_sales/02_wrangled_data/bike_orderlines.csv\")\n\n# RDS ----\nbike_orderlines_wrangled_tbl %>% \n  write_rds(\"01_tidyverse_files/01_bike_sales/02_wrangled_data/bike_orderlines.rds\")\n```\n:::\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<link href=\"../../site_libs/pagedtable-1.1/css/pagedtable.css\" rel=\"stylesheet\" />\r\n<script src=\"../../site_libs/pagedtable-1.1/js/pagedtable.js\"></script>\r\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}